
Структура папки: 
================= 
    Image.cshtml
    temp_full.txt
    _BackgroundSection.cshtml
    
Подпапки отсутствуют 

 
================= 
 
/Image.cshtml: 
@inherits Umbraco.Cms.Web.Common.Views.UmbracoViewPage
@using TestUmbraco.Helpers
@using Umbraco.Cms.Core.Models.PublishedContent

@inject ImageHelper ImageHelperService

@{
    var mediaItem = Model.Value<IPublishedContent>("img");
    if (mediaItem == null) return;
    
    var cropAlias = ViewData["CropAlias"] as string;
    var cssClass = ViewData["CssClass"] as string;
    var lazyLoad = ViewData["LazyLoad"] as bool? ?? true;
    
    var attributes = new Dictionary<string, string>();
    if (!string.IsNullOrEmpty(cssClass))
    {
        attributes.Add("class", cssClass);
    }
}

@if (mediaItem != null)
{
    // ? Используем синхронный метод вместо асинхронного
    var imageContent = ImageHelperService.RenderImage(
        Model, 
        "img", 
        cropAlias, 
        attributes, 
        lazyLoad);
    
    <div class="image-wrapper @cssClass">
        @Html.Raw(imageContent.ToString())
        
        @if (!string.IsNullOrEmpty(mediaItem.Value<string>("title")))
        {
            <figcaption class="image-caption">
                @mediaItem.Value<string>("title")
            </figcaption>
        }
    </div>
} 
 
/_BackgroundSection.cshtml: 
@using TestUmbraco.Models
@using TestUmbraco.Services
@inject IUmbracoBackgroundService BackgroundService
@model BackgroundSectionModel

@{
    // Получаем фоновые классы из сервиса
    var backgroundResult = BackgroundService.ProcessBackground(Model.Settings, Model.ComponentId, Model.Prefix);
    var backgroundClass = backgroundResult.CssClass ?? "";
    
    // Собираем все классы
    var allClasses = new List<string>();
    
    // Базовый класс компонента
    if (!string.IsNullOrWhiteSpace(Model.BaseClass))
    {
        allClasses.Add(Model.BaseClass.Trim());
    }
    
    // Фоновые классы
    if (!string.IsNullOrWhiteSpace(backgroundClass))
    {
        allClasses.Add(backgroundClass.Trim());
    }
    
    // Дополнительные классы
    if (!string.IsNullOrWhiteSpace(Model.AdditionalClasses))
    {
        allClasses.Add(Model.AdditionalClasses.Trim());
    }
    
    var finalClass = string.Join(" ", allClasses);
    var containerClass = Model.ContainerClass?.Trim() ?? "";
}

<section class="@finalClass">
    <!-- Элемент оверлея (добавляется через CSS) -->
    
    @if (!string.IsNullOrWhiteSpace(containerClass))
    {
        <div class="@containerClass">
            @Model.Content?.Invoke(Model)
        </div>
    }
    else
    {
        @Model.Content?.Invoke(Model)
    }
</section> 
 
