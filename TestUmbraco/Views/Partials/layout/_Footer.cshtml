@using Umbraco.Cms.Core.Models.Blocks
@using Umbraco.Cms.Core.Models.PublishedContent
@using Umbraco.Extensions
@using Link = Umbraco.Cms.Core.Models.Link
@inherits Umbraco.Cms.Web.Common.Views.UmbracoViewPage

@{
    var root = Umbraco.ContentAtRoot()
        .FirstOrDefault(c => c.ContentType.Alias == "blockGrid");
    if (root == null)
    {
        return;
    }
    var footerBlock = root.Value<BlockListItem>("footer");

    if (footerBlock?.Content == null)
    {
        return;
    }
    var footerNode = footerBlock.Content;
    var copyright = footerNode.Value<string>("footerCopyright");
    var showYear = footerNode.Value<bool>("footerShowCurrentYear");
    var currentYear = showYear ? DateTime.Now.Year.ToString() : null;

    var contactBlocks = footerNode.Value<BlockListModel>("contact");
    var socialBlocks = footerNode.Value<BlockListModel>("social");
    var navFooterBlock = footerNode.Value<BlockListItem>("navFooter");
    var privacyLinks = footerNode.Value<IEnumerable<Link>>("footerPrivacyLink") ?? Enumerable.Empty<Link>();
    var termsLinks = footerNode.Value<IEnumerable<Link>>("footerTermsLink") ?? Enumerable.Empty<Link>();
    var formBlocks = footerNode.Value<BlockListModel>("footerForm");
}

<footer class="site-footer">
    <div class="container">
        <div class="row">
            <div class="col-12">
                @if (!string.IsNullOrWhiteSpace(copyright) || showYear)
                {
                    <div class="footer-copyright">
                        @copyright
                        @if (showYear)
                        {
                            <span class="current-year">@currentYear</span>
                        }
                    </div>
                }

                @if (contactBlocks?.Any() == true)
                {
                    <div class="footer-contacts">
                        @await Html.GetBlockListHtmlAsync(contactBlocks)
                    </div>
                }
            </div>
            </div>
            <div class="row">
            <div class="col-md-4">
                @if (socialBlocks?.Any() == true)
                {
                    <div class="footer-social">
                        @await Html.GetBlockListHtmlAsync(socialBlocks)
                    </div>
                }

                @if (navFooterBlock != null)
                {
                    <div class="footer-nav">
                        @await Html.PartialAsync("blocklist/Components/" + navFooterBlock.Content.ContentType.Alias, navFooterBlock)
                    </div>
                }
            </div>

            <div class="col-md-4">
                @if (formBlocks?.Any() == true)
                {
                    <div class="footer-form">
                        @await Html.GetBlockListHtmlAsync(formBlocks)
                    </div>
                }
            </div>
        </div>

        <div class="row">
            <div class="col-12 footer-legal-links">
                @if (privacyLinks.Any())
                {
                    foreach (var link in privacyLinks)
                    {
                        <a href="@link.Url" target="@link.Target" class="privacy-link">
                            @(link.Name ?? "Политика конфиденциальности")
                        </a>
                    }
                }
                @if (termsLinks.Any())
                {
                    foreach (var link in termsLinks)
                    {
                        <a href="@link.Url" target="@link.Target" class="terms-link">
                            @(link.Name ?? "Условия использования")
                        </a>
                    }
                }
            </div>
        </div>
    </div>
</footer>