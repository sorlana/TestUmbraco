@using Umbraco.Cms.Web.Common.PublishedModels;
@using ContentModels = Umbraco.Cms.Web.Common.PublishedModels;
@model IPublishedContent

@{
    IPublishedContent? favicon = null;
    
    if (Model is ContentModels.BlockGrid blockGridPage && blockGridPage.HasProperty("favicon"))
    {
        favicon = blockGridPage.Value<IPublishedContent>("favicon");
    }
}

@if (favicon != null)
{
    var faviconUrl = favicon.Url() ?? string.Empty;
    
    if (!string.IsNullOrEmpty(faviconUrl))
    {
        var isSvg = faviconUrl.EndsWith(".svg", StringComparison.OrdinalIgnoreCase) || 
                    faviconUrl.Contains(".svg?", StringComparison.OrdinalIgnoreCase);
        
        if (isSvg)
        {
            <!-- SVG для современных браузеров -->
            <link rel="icon" type="image/svg+xml" href="@faviconUrl" sizes="any">
            <!-- PNG для совместимости -->
            <link rel="icon" href="@faviconUrl?format=png&width=32&height=32" type="image/png" sizes="32x32">
            <link rel="icon" href="@faviconUrl?format=png&width=16&height=16" type="image/png" sizes="16x16">
            <link rel="apple-touch-icon" href="@faviconUrl?format=png&width=180&height=180">
        }
        else
        {
            <!-- Для других форматов (ICO, PNG) -->
            <link rel="icon" href="@faviconUrl">
        }
    }
}
else
{
    <!-- Fallback favicon -->
    <link href="~/favicon.ico" rel="icon">
}